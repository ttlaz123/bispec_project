<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Revisiting the BBB Bispectrum Project</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Revisiting the BBB Bispectrum Project</h1>
        <time datetime="2025-10-30" class="published updated">2025 October 30</time> â€”
        Tongtian (Tom) Liu
    </header>

    <hr>

    <section>
        <h2>Introduction</h2>
       <p><strong>Summary:</strong>
        We reproduce Toshiya's BBB bispectrum results to verify our estimator for the standard BK sims. 
        We then add a nongaussian part, scaled by \(f_{NL}\) to test the estimator's ability to recover the injected nongausianity.
        The estimator currently does not appear to accurately recover injected large \(f_{NL}\).
    </p>

        <p>This posting builds upon previous updates:</p>
        <ul>
            <li><a href="../20160000_namikawa/20231117_bispec/">2023-11-17: Polarization Bispectrum Analysis</a></li>
            <li><a href="../wip_nonGaussianity/">2022-07-18: Equilateral fNL from B18 95GHz Bispectrum</a></li>
            <li><a href="../20160000_namikawa/20210520_bispec/">2021-05-20: Equilateral B-mode bispectrum analysis</a></li>
            <li><a href="../20200703_bispec/">2020-07-03: Polarization Bispectrum Analysis</a></li>
            <li><a href="../20190805_bispec/">2019-08-05: Polarization Bispectrum Analysis</a></li>
        </ul>
        <p>
        While the simplest inflationary models predict that primordial fluctuations should be nearly Gaussian, 
        any deviations from this is captured by higher-order correlation functions like the bispectrum, and it can constrain more complex 
        inflationary scenarios. The \(B\)-mode bispectrum (BBB) provides a way to search for 
        primordial non-Gaussianity, quantified by the parameter $\mathbf{f_{NL}}$. 
        A non-zero $f_{NL}$ could indicate different models of inflation, including thos with axion fields.
    </p>
    <p>
        <a href="https://arxiv.org/pdf/1905.05697">Planck's 2019 paper</a> provides a more thorough definition of the different types of bispectra 
        (equilateral, local, orthogonal) and their relationship with the \(f_{NL}\) parameter.
        Toshiya's <a href="https://www.overleaf.com/project/66212da42d93d0485590c09c">paper draft</a> and previous postings outline the 
        derivations for calculating the specific bispectrum and \(f_{NL}\) that BICEP is sensitive to, namely the equilateral B-mode bispectrum, 
        which we refer to as \(f_{NL}^{tens}\).
        </p>
        <p>
            To summarize, Toshiya's pipeline generates three different sets of \(a_{lm}\)'s: \(a_{lm}^{BICEP}\), \(a_{lm}^{G}\), and \(a_{lm}^{NG}\).
            Where \(a_{lm}^{BICEP}\) represents the standard BICEP sims, including dust and noise,  \(a_{lm}^{G}\) is a set of guassian simulations
            without dust or noise, and \(a_{lm}^{NG}\) represents the non-gaussian components. Thus, 
            \(a^{tot}_{lm} = \sqrt{r}  \(a_{lm}^{G}\) + A\frac{f_{NL}^{tens}\(a_{lm}^{NG}\)}{r}\)
            where \(r\) is the tensor to scalar ratio, and A=10^50 is a constant scaling factor used by Toshiya when saving his files. 
        </p>
        <p>
            The \(a_{lm}\)'s are then used to calculate filtered maps. The maps are binned and used to extract the binned BBB bispectra \(b_{ijk}\),
            where \(ijk\) refers to the combination of the BICEP bins.
            The calculated bispectra are then run through the estimator as calculated in 
        </p>
    </section>

    <section>
     Recalculating fNL using files from <code>/n/holylfs04/LABS/kovac_lab/users/namikawa/B33y/bispec_bbb/</code>

        <figure>
            <img alt="Remade fNL histograms" id="fnl" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
               
                Recreating histograms in the Overleaf draft 
            </figcaption>

            <script type="text/javascript">
                pager.link("#fnl", {
                    'fNL sim value|scaling':[
                        'fNL = 0|',
                    ],
                    'Bin Num|bn': [
                        '7|7',
                        '8|8',
                        '9|9',
                        '10|10',
                        '11|11',
                        '16|16',
                    ],
                    'Ell Range|oL':[
                        '1-300|1-300',
                        '20-350|20-350',
                        '20-580|20-580',
                        '30-350|30-350',
                    ],
                    'Zeroed Off diagonal covariance matrices|zerodiag':[
                        'True|True',
                        'False|False',
                    ],
                    'Frequency|nu':[
                        '100|100'
                    ],
                    'Jackknife|jk':[
                        'None|',
                        'j1|_j1',
                        'j2|_j2',
                        'j3|_j3',
                        'j4|_j4',
                        'j5|_j5',
                        'j6|_j6',
                        'j7|_j7',
                        'j8|_j8',
                        'j9|_j9',
                        'ja|_ja',
                        'jb|_jb',
                        'jc|_jc',
                        'jd|_jd',
                        'je|_je',

                    ],

                }, function (params) {
                    let dirbase = '/liuto/home/GitHub/bispec_project/';
                    dirbase = dirbase + 'fnl_figs' + params.scaling + '/'
                    let filename = 'b3d_1var_nu' + params.nu + 
                                '_lx0_nobl_lcdm' + params.jk + 
                                '_dp1102_oL' + params.oL + 
                                '_b' + params.bn + 
                                '_diag' + params.zerodiag
                    let filepath = dirbase + filename + '.png'
                    console.log(filepath)
                    return filepath;
                });

                pager.setparams({ 
                    'bn': '9',
                     'oL': '20-350',
                     'zerodiag': 'False',
                     'nu': '100',
                     'jk':'',
                     'scaling':'',
                }   

                );
            </script>
        </figure>


        <figure>
            <img alt="Injected fNL histograms" id="inj" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
               New histograms with injected nongaussianity with different values of fNL

            </figcaption>

            <script type="text/javascript">
                pager.link("#inj", {
                    'fNL injected value|scaling2':[
                        'fNL = 1|0001',
                        'fNL = 10|0010',
                        'fNL = 32|0032',
                        'fNL = 100|0100',
                        'fNL = 1000|1000',
                    ],
                    'Covariance matrix used|cov':[
                        'Calculated from fNL=0 sims|_scaled',
                        'From fNL sims same as injected value|_defcov',
                    ],
                    'Bin Num|bn2': [
                        '9|9',
                    ],
                    'Ell Range|oL2':[
                        '30-350 (alm = alm_bicep + glm + flm*fnl)|30-350',
                        '20-350 (alm = alm_bicep + glm + flm*fnl)|20-350',
                        '20-350 (alm = glm + flm*fnl)|20-350x',
                    ],
                    'Zeroed Off diagonal covariance matrices|zerodiag':[
                        'True|True',
                        'False|False',
                    ],
                    'Frequency|nu':[
                        '100|100'
                    ],
                    'Jackknife|jk2':[
                        'None|',
                    ],

                }, function (params) {
                    let dirbase = '/liuto/home/GitHub/bispec_project/';
                    let cov = params.cov
                    dirbase = dirbase + 'fnl_figs' + cov + '/'
                    let filename = 'b3d_1var_nu' + params.nu + 
                                '_lx0_nobl_lcdm' + params.jk2 + 
                                '_dp1102_oL' + params.oL2 + 
                                '_b' + params.bn2 + 
                                '_fnl' + params.scaling2 +
                                '_diag' + params.zerodiag 
                    let filepath = dirbase + filename + '.png'
                    console.log(filepath)
                    return filepath;
                });

                pager.setparams({ 
                    'bn2': '9',
                     'oL2': '30-350',
                     'zerodiag': 'False',
                     'nu': '100',
                     'jk2':'',
                     'scaling2':'0001',
                     'cov':'_scaled'
                }   

                );
            </script>
        </figure>
       
    </section>

   
    <section>
        <h2>Appendix</h2>
        <p>All relevant files and directories:
        </p>
        <ul>
            <li>BBB bispectrum files: <code>/n/holylfs04/LABS/kovac_lab/users/namikawa/B33y/bispec_bbb/</code></li>
            <li>Bispec generator code: <code>/n/home02/toshiyan/bicep2_analysis/cmbrectool/bispec/</code></li>
            <li>Analysis library: <code>/n/home02/toshiyan/Lib/cmblensplus/utils/analysis.py</code></li>
            <li>Fortran library: <code>/n/home02/toshiyan/Lib/f90/</code></li>
            
        </ul>
    </section>
</body>

</html>
